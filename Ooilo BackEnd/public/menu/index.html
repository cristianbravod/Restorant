<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Serif%3Awght%40400%3B500%3B700%3B900&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />
    <title>Ooilo Taqueria - Menú Digital</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <style>
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #161413;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .error-message {
            background-color: #fee;
            color: #c33;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem;
        }
        .item-image {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            border-radius: 0.75rem;
            overflow: hidden;
        }
        .item-image:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        .item-image:active {
            transform: scale(0.98);
        }

        /* Modal de imagen */
        .image-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .image-modal.show {
            display: flex;
        }

        /* Desktop modal - CORREGIDO para verse como Birria */
        .modal-content {
            position: relative;
            max-width: 600px;
            max-height: 80vh;
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            animation: zoomIn 0.3s ease;
            overflow-y: auto;
            width: auto;
            min-width: 400px;
        }

        .modal-image {
            width: 100%;
            height: auto;
            max-height: 350px;
            min-height: 200px;
            object-fit: cover;
            border-radius: 0.75rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .modal-info {
            padding: 0;
            text-align: center;
        }

        .modal-title {
            font-size: 1.75rem;
            font-weight: 800;
            color: #161413;
            margin-bottom: 0.75rem;
            line-height: 1.2;
        }

        .modal-price {
            font-size: 1.5rem;
            color: #27ae60;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .modal-description {
            color: #6b7280;
            line-height: 1.5;
            margin-bottom: 1rem;
            font-size: 1rem;
            text-align: center;
            padding: 0 0.5rem;
        }

        .modal-badges {
            display: flex;
            justify-content: center;
            gap: 0.75rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .modal-badges .vegetarian-badge,
        .modal-badges .spicy-badge {
            font-size: 0.875rem !important;
            padding: 0.5rem 1rem !important;
            border-radius: 1.5rem !important;
            font-weight: 600 !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
        }

        .modal-extra-info {
            text-align: left;
            background: #f8fafc;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            border: 1px solid #e2e8f0;
        }

        .modal-extra-info p {
            margin-bottom: 0.5rem;
            color: #4b5563;
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .modal-extra-info p:last-child {
            margin-bottom: 0;
        }

        .close-modal {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 35px;
            height: 35px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 1.25rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            z-index: 1001;
        }

        .close-modal:hover {
            background: #e74c3c;
            transform: scale(1.05);
        }

        /* Tablets - Tamaños similares a desktop */
        @media (max-width: 1024px) and (min-width: 769px) {
            .modal-content {
                max-width: 550px;
                max-height: 85vh;
                min-width: 380px;
                padding: 1.25rem;
            }

            .modal-image {
                max-height: 320px;
                min-height: 180px;
                margin-bottom: 1rem;
            }

            .modal-title {
                font-size: 1.625rem;
                margin-bottom: 0.75rem;
            }

            .modal-price {
                font-size: 1.375rem;
                margin-bottom: 1rem;
            }

            .modal-description {
                font-size: 0.95rem;
                margin-bottom: 1rem;
            }

            .modal-badges .vegetarian-badge,
            .modal-badges .spicy-badge {
                font-size: 0.8rem !important;
                padding: 0.45rem 0.9rem !important;
            }

            .modal-extra-info {
                padding: 0.875rem;
                margin-top: 0.875rem;
            }

            .modal-extra-info p {
                font-size: 0.9rem;
                margin-bottom: 0.45rem;
            }

            .close-modal {
                width: 32px;
                height: 32px;
                font-size: 1.125rem;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes zoomIn {
            from { 
                opacity: 0;
                transform: scale(0.5);
            }
            to { 
                opacity: 1;
                transform: scale(1);
            }
        }

        /* MÓVIL: Modal de pantalla completa */
        @media (max-width: 768px) {
            .image-modal {
                background: rgba(0, 0, 0, 0.98);
                padding: 0;
                align-items: flex-start;
            }

            .modal-content {
                width: 100vw;
                height: 100vh;
                max-width: 100vw;
                max-height: 100vh;
                margin: 0;
                padding: 25px 20px;
                border-radius: 0;
                box-shadow: none;
                overflow-y: auto;
                animation: slideUp 0.3s ease;
                display: flex;
                flex-direction: column;
            }

            .modal-image {
                width: 100%;
                height: auto;
                max-height: 45vh;
                min-height: 320px;
                object-fit: cover;
                border-radius: 15px;
                margin-bottom: 25px;
                flex-shrink: 0;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            }

            .modal-info {
                flex: 1;
                display: flex;
                flex-direction: column;
                justify-content: flex-start;
                text-align: center;
                padding: 0;
            }

            .modal-title {
                font-size: 2.5rem;
                margin-bottom: 20px;
                font-weight: 900;
                color: #161413;
                line-height: 1.1;
                letter-spacing: -0.02em;
            }

            .modal-price {
                font-size: 2.25rem;
                margin-bottom: 25px;
                color: #27ae60;
                font-weight: 800;
                text-shadow: 0 2px 4px rgba(39, 174, 96, 0.2);
            }

            .modal-description {
                font-size: 1.375rem;
                line-height: 1.5;
                margin-bottom: 25px;
                color: #374151;
                text-align: left;
                font-weight: 400;
                padding: 0 5px;
            }

            .modal-badges {
                gap: 15px;
                margin-bottom: 25px;
                justify-content: center;
            }

            .modal-badges .vegetarian-badge,
            .modal-badges .spicy-badge {
                font-size: 1.25rem !important;
                padding: 12px 20px !important;
                border-radius: 25px !important;
                font-weight: 700 !important;
                letter-spacing: 0.5px !important;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
            }

            .modal-extra-info {
                background: #f8fafc;
                padding: 25px;
                border-radius: 15px;
                margin-top: 20px;
                text-align: left;
                border: 2px solid #e2e8f0;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            }

            .modal-extra-info p {
                font-size: 1.375rem;
                margin-bottom: 15px;
                color: #1f2937;
                line-height: 1.4;
                font-weight: 600;
            }

            .close-modal {
                position: fixed;
                top: 30px;
                right: 25px;
                width: 60px;
                height: 60px;
                background: rgba(0, 0, 0, 0.8);
                backdrop-filter: blur(10px);
                font-size: 2.5rem;
                z-index: 1002;
                border: 3px solid rgba(255, 255, 255, 0.3);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            }

            .close-modal:active {
                background: #e74c3c;
                transform: scale(0.9);
            }

            @keyframes slideUp {
                from { 
                    opacity: 0;
                    transform: translateY(50px);
                }
                to { 
                    opacity: 1;
                    transform: translateY(0);
                }
            }
        }

        /* Móviles muy pequeños */
        @media (max-width: 390px) {
            .modal-content {
                padding: 20px 15px;
            }

            .modal-image {
                min-height: 280px;
                max-height: 42vh;
                border-radius: 12px;
                margin-bottom: 20px;
            }

            .modal-title {
                font-size: 2.25rem;
                margin-bottom: 18px;
                line-height: 1.1;
            }

            .modal-price {
                font-size: 2rem;
                margin-bottom: 20px;
            }

            .modal-description {
                font-size: 1.25rem;
                margin-bottom: 20px;
                line-height: 1.4;
            }

            .modal-badges .vegetarian-badge,
            .modal-badges .spicy-badge {
                font-size: 1.125rem !important;
                padding: 10px 18px !important;
            }

            .modal-extra-info {
                padding: 20px;
                margin-top: 15px;
            }

            .modal-extra-info p {
                font-size: 1.25rem;
                margin-bottom: 12px;
            }

            .close-modal {
                width: 55px;
                height: 55px;
                font-size: 2.25rem;
                top: 25px;
                right: 20px;
            }
        }

        /* Landscape mode en móvil */
        @media (max-width: 768px) and (orientation: landscape) {
            .modal-content {
                height: 100vh;
                padding: 20px;
                flex-direction: row;
                align-items: flex-start;
                gap: 25px;
            }

            .modal-image {
                width: 45%;
                max-height: 75vh;
                min-height: 250px;
                margin-right: 0;
                margin-bottom: 0;
                flex-shrink: 0;
            }

            .modal-info {
                width: 55%;
                flex: 1;
                padding-left: 0;
                overflow-y: auto;
                max-height: 75vh;
            }

            .modal-title {
                font-size: 2rem;
                text-align: left;
                margin-bottom: 15px;
            }

            .modal-price {
                font-size: 1.75rem;
                text-align: left;
                margin-bottom: 20px;
            }

            .modal-description {
                font-size: 1.125rem;
                margin-bottom: 18px;
                text-align: left;
            }

            .modal-badges {
                justify-content: flex-start;
                margin-bottom: 18px;
            }

            .modal-badges .vegetarian-badge,
            .modal-badges .spicy-badge {
                font-size: 1rem !important;
                padding: 8px 16px !important;
            }

            .modal-extra-info {
                margin-top: 15px;
                padding: 18px;
            }

            .modal-extra-info p {
                font-size: 1.125rem;
                margin-bottom: 10px;
            }

            .close-modal {
                top: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 2rem;
            }
        }

        /* Prevenir scroll del body cuando el modal está abierto */
        body.modal-open {
            overflow: hidden;
            position: fixed;
            width: 100%;
            height: 100%;
        }
        .price {
            color: #27ae60;
            font-weight: bold;
        }
        .vegetarian-badge {
            background-color: #27ae60;
            color: white;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            margin-left: 0.5rem;
        }
        .spicy-badge {
            background-color: #e74c3c;
            color: white;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            margin-left: 0.5rem;
        }
        .categoria-section {
            margin-bottom: 1rem;
        }
        .categoria-count {
            font-size: 0.875rem;
            color: #6b7280;
            font-weight: 400;
        }

        /* RESPONSIVE DESIGN */
        :root {
            --header-height: 60px;
            --mobile-nav-height: 60px;
        }

        @media (max-width: 768px) {
            header {
                padding: 0.75rem 1rem !important;
                position: sticky;
                top: 0;
                z-index: 50;
                background: rgba(255, 255, 255, 0.95);
                backdrop-filter: blur(10px);
            }
            
            header .flex.items-center.gap-9 {
                display: none !important;
            }
            
            #main-content {
                padding: 0.5rem !important;
                padding-bottom: calc(var(--mobile-nav-height) + 1rem) !important;
            }
            
            /* Textos más grandes en móvil - GENERAL */
            .text-base {
                font-size: 1.25rem !important;
                line-height: 1.6 !important;
            }
            
            .text-sm {
                font-size: 1.125rem !important;
                line-height: 1.5 !important;
            }
            
            .text-xs {
                font-size: 1rem !important;
                line-height: 1.4 !important;
            }
            
            /* Títulos de categorías más grandes */
            .text-\\[22px\\] {
                font-size: 1.75rem !important;
                line-height: 1.3 !important;
                font-weight: 800 !important;
                margin-bottom: 1rem !important;
            }
            
            /* Precios más prominentes */
            .price {
                font-size: 1.5rem !important;
                font-weight: 800 !important;
            }
            
            /* Badges más grandes y legibles */
            .vegetarian-badge,
            .spicy-badge {
                font-size: 1rem !important;
                padding: 0.5rem 1rem !important;
                margin: 0.375rem 0.375rem 0.375rem 0 !important;
                border-radius: 1.5rem !important;
                font-weight: 600 !important;
            }
            
            /* Información del restaurante más legible */
            #restaurant-info p {
                font-size: 1.125rem !important;
                line-height: 1.5 !important;
                margin-bottom: 0.75rem !important;
            }
            
            #restaurant-info strong {
                font-weight: 700 !important;
            }
            
            /* Título principal más grande */
            .text-lg {
                font-size: 1.375rem !important;
                font-weight: 800 !important;
            }
            
            /* Banner más legible */
            .text-\\[40px\\] {
                font-size: 2.25rem !important;
                line-height: 1.1 !important;
            }
            
            .text-\\[22px\\] {
                font-size: 1.5rem !important;
                line-height: 1.2 !important;
            }
            
            /* Navegación móvil más grande */
            .mobile-navigation {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: white;
                border-top: 1px solid #f3f2f1;
                padding: 0.875rem 0;
                z-index: 40;
                display: flex;
                justify-content: space-around;
                align-items: center;
                height: var(--mobile-nav-height);
                box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            }
            
            .mobile-nav-item {
                display: flex;
                flex-direction: column;
                align-items: center;
                text-decoration: none;
                color: #6b7280;
                font-size: 0.875rem;
                font-weight: 600;
                padding: 0.375rem 0.75rem;
                border-radius: 0.75rem;
                transition: all 0.2s ease;
                min-width: 70px;
                min-height: 50px;
            }
            
            .mobile-nav-item svg {
                margin-bottom: 0.375rem;
                width: 24px;
                height: 24px;
            }
            
            .mobile-nav-item:hover,
            .mobile-nav-item.active {
                color: #3b82f6;
                background-color: #eff6ff;
            }
            
            /* Botones más grandes */
            button {
                min-height: 48px !important;
                min-width: 48px !important;
                font-size: 1rem !important;
            }
            
            /* Espaciado mejorado entre elementos */
            .p-4 {
                padding: 1.25rem !important;
            }
            
            /* Items del menú con mejor espaciado */
            .flex.items-stretch.justify-between {
                flex-direction: column !important;
                gap: 1.25rem !important;
            }
            
            /* Imagen del item en móvil */
            .flex.items-stretch.justify-between .w-full.bg-center {
                width: 100% !important;
                height: 220px !important;
                flex: none !important;
                border-radius: 0.75rem !important;
            }
        }

        @media (min-width: 769px) {
            .mobile-navigation {
                display: none !important;
            }
        }

        @media (max-width: 1023px) {
            .layout-content-container.w-80 {
                display: none !important;
            }
            
            #main-content {
                padding: 1rem !important;
            }
            
            .layout-content-container.max-w-\\[960px\\] {
                max-width: 100% !important;
            }
        }

        html {
            scroll-behavior: smooth;
        }
        
        @media (prefers-reduced-motion: reduce) {
            html {
                scroll-behavior: auto;
            }
            
            .item-image {
                transition: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="relative flex size-full min-h-screen flex-col bg-white group/design-root overflow-x-hidden" style='font-family: "Noto Serif", "Noto Sans", sans-serif;'>
        <div class="layout-container flex h-full grow flex-col">
            <!-- Header -->
            <header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#f3f2f1] px-10 py-3">
                <div class="flex items-center gap-4 text-[#161413]">
                    <div class="w-8 h-8 flex items-center justify-center">
                        <img 
                            id="restaurant-icon" 
                            src="" 
                            alt="Ooilo Taqueria" 
                            class="w-full h-full object-contain rounded"
                            style="display: none;"
                            onload="this.style.display='block'"
                            onerror="this.style.display='none'; document.getElementById('fallback-icon').style.display='block'"
                        />
                        <svg id="fallback-icon" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-full h-full" style="display: block;">
                            <path d="M24 4C19.58 4 16 7.58 16 12C16 14.5 17.5 16.67 19.7 17.74L19 20H17C15.34 20 14 21.34 14 23V26C14 27.66 15.34 29 17 29H19V42C19 43.1 19.9 44 21 44H27C28.1 44 29 43.1 29 42V29H31C32.66 29 34 27.66 34 26V23C34 21.34 32.66 20 31 20H29L28.3 17.74C30.5 16.67 32 14.5 32 12C32 7.58 28.42 4 24 4ZM24 6C27.31 6 30 8.69 30 12C30 15.31 27.31 18 24 18C20.69 18 18 15.31 18 12C18 8.69 20.69 6 24 6ZM22 13C22 13.55 21.55 14 21 14C20.45 14 20 13.55 20 13C20 12.45 20.45 12 21 12C21.55 12 22 12.45 22 13ZM28 13C28 13.55 27.55 14 27 14C26.45 14 26 13.55 26 13C26 12.45 26.45 12 27 12C27.55 12 28 12.45 28 13ZM23 15H25V16H23V15Z" fill="currentColor"/>
                        </svg>
                    </div>
                    <h2 class="text-[#161413] text-lg font-bold leading-tight tracking-[-0.015em]" id="restaurant-name">Ooilo Taqueria</h2>
                </div>
                <div class="flex flex-1 justify-end gap-8">
                    <div class="flex items-center gap-9">
                        <a class="text-[#161413] text-sm font-medium leading-normal" href="#menu">Menú</a>
                        <a class="text-[#161413] text-sm font-medium leading-normal" href="#ubicacion">Ubicación</a>
                        <a class="text-[#161413] text-sm font-medium leading-normal" href="#reservaciones">Reservaciones</a>
                    </div>
                    <button class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 bg-[#f3f2f1] text-[#161413] gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5">
                        <div class="text-[#161413]" data-icon="ShoppingCart" data-size="20px" data-weight="regular">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor" viewBox="0 0 256 256">
                                <path d="M222.14,58.87A8,8,0,0,0,216,56H54.68L49.79,29.14A16,16,0,0,0,34.05,16H16a8,8,0,0,0,0,16h18L59.56,172.29a24,24,0,0,0,5.33,11.27,28,28,0,1,0,44.4,8.44h45.42A27.75,27.75,0,0,0,152,204a28,28,0,1,0,28-28H83.17a8,8,0,0,1-7.87-6.57L72.13,152h116a24,24,0,0,0,23.61-19.71l12.16-66.86A8,8,0,0,0,222.14,58.87ZM96,204a12,12,0,1,1-12-12A12,12,0,0,1,96,204Zm96,0a12,12,0,1,1-12-12A12,12,0,0,1,192,204Zm4-74.57A8,8,0,0,1,188.1,136H69.22L57.59,72H206.41Z"></path>
                            </svg>
                        </div>
                    </button>
                </div>
            </header>

            <!-- Loading -->
            <div id="loading" class="loading">
                <div class="spinner"></div>
            </div>

            <!-- Error Message -->
            <div id="error-message" class="error-message" style="display: none;">
                <h3>Error cargando el menú</h3>
                <p>No se pudo conectar con el servidor. Por favor, inténtalo más tarde.</p>
                <button onclick="cargarMenu()" class="mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                    Reintentar
                </button>
            </div>

            <!-- Main Content -->
            <div id="main-content" class="gap-1 px-6 flex flex-1 justify-center py-5" style="display: none;">
                <div class="layout-content-container flex flex-col w-80">
                    <div class="flex w-full grow bg-white @container p-4">
                        <div class="w-full gap-1 overflow-hidden bg-white @[480px]:gap-2 aspect-[2/3] rounded-xl flex">
                            <div id="hero-image" class="w-full bg-center bg-no-repeat bg-cover aspect-auto rounded-none flex-1"
                                style='background-image: url("Vertical.jpg"); background-size: 120%;'>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="layout-content-container flex flex-col max-w-[960px] flex-1">
                    <!-- Banner -->
                    <div class="@container">
                        <div class="@[480px]:px-4 @[480px]:py-3">
                            <div class="bg-cover bg-center flex flex-col justify-end overflow-hidden bg-white @[480px]:rounded-xl min-h-[218px]"
                                style='background-image: linear-gradient(0deg, rgba(0, 0, 0, 0.4) 0%, rgba(0, 0, 0, 0) 25%), url("https://lh3.googleusercontent.com/aida-public/AB6AXuA8A4J9Xm78PE2PWK9efq1hNaCw3i-mgfg8cz2ZPj2AFgIkp8PCJtN3vRuQTy8MK5wsSNVdoDJCpinHEY0FkgDEgBMe1K6AR6HTwC4ifXJqsKUip9T7ozPu_mkd6zSCTGSGQ6t_RaVTiVxxQ3fv0rdfyzn6UDqsJI3iJ9opjwajwfjCXIqoiucdNoltMVULgDNrwwRjODOGnWlmABCxGtjIjmxAvHXQZhTzP5V-9qcT2TB5RFjXD97TbDi_X7YXZrzW7xgGj1-LO2XT");'>
                                <div class="flex flex-col p-4 gap-2">
                                    <h1 class="text-white tracking-light text-[40px] font-bold leading-tight" id="banner-restaurant-name">
                                        Ooilo Taqueria
                                    </h1>
                                    <p class="text-white tracking-light text-[22px] font-medium leading-tight" id="banner-subtitle">
                                        Nuestro Menú
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Platos Especiales -->
                    <div id="platos-especiales-section" style="display: none;">
                        <h2 class="text-[#161413] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">
                            🌟 Platos Especiales
                        </h2>
                        <div id="platos-especiales-container">
                            <!-- Los platos especiales se cargarán aquí -->
                        </div>
                    </div>

                    <!-- Categorías del menú -->
                    <div id="menu-container">
                        <!-- Las categorías se cargarán aquí dinámicamente -->
                    </div>

                    <!-- Información del restaurante -->
                    <div class="p-4 mt-8 bg-[#f3f2f1] rounded-xl">
                        <h3 class="text-[#161413] text-lg font-bold mb-2">📍 Información</h3>
                        <div id="restaurant-info">
                            <p><strong>Teléfono:</strong> <span id="restaurant-phone">Cargando...</span></p>
                            <p><strong>Horarios:</strong> <span id="restaurant-hours">Cargando...</span></p>
                            <p><strong>Dirección:</strong> <span id="restaurant-address">Cargando...</span></p>
                        </div>
                        <p class="text-sm text-[#80726b] mt-2">
                            <span id="last-updated">Última actualización: --</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navegación móvil fija -->
    <nav class="mobile-navigation">
        <a href="#menu" class="mobile-nav-item active" onclick="setActiveNavItem(this)">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                <path d="M224,128a8,8,0,0,1-8,8H40a8,8,0,0,1,0-16H216A8,8,0,0,1,224,128ZM40,72H216a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16ZM216,184H40a8,8,0,0,0,0,16H216a8,8,0,0,0,0-16Z"></path>
            </svg>
            <span>Menú</span>
        </a>
        <a href="#platos-especiales-section" class="mobile-nav-item" onclick="setActiveNavItem(this)">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                <path d="M234.5,114.38l-45.1,39.36,13.51,58.6a16,16,0,0,1-23.84,17.34l-51.11-31-51,31a16,16,0,0,1-23.84-17.34L66.61,153.8,21.5,114.38a16,16,0,0,1,9.11-28.06l59.46-5.15,23.21-55.36a15.95,15.95,0,0,1,29.44,0L165.93,81.17l59.46,5.15A16,16,0,0,1,234.5,114.38Z"></path>
            </svg>
            <span>Especiales</span>
        </a>
        <a href="#ubicacion" class="mobile-nav-item" onclick="setActiveNavItem(this)">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                <path d="M128,64a40,40,0,1,0,40,40A40,40,0,0,0,128,64Zm0,64a24,24,0,1,1,24-24A24,24,0,0,1,128,128Zm0-112a88.1,88.1,0,0,0-88,88c0,31.4,14.51,64.68,42,96.25a254.19,254.19,0,0,0,41.45,38.3,8,8,0,0,0,9.18,0A254.19,254.19,0,0,0,174,200.25c27.45-31.57,42-64.85,42-96.25A88.1,88.1,0,0,0,128,16Zm0,206c-16.53-13-72-60.75-72-118a72,72,0,0,1,144,0C200,161.23,144.53,209,128,222Z"></path>
            </svg>
            <span>Ubicación</span>
        </a>
        <a href="#reservaciones" class="mobile-nav-item" onclick="setActiveNavItem(this)">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                <path d="M208,32H184V24a8,8,0,0,0-16,0v8H88V24a8,8,0,0,0-16,0v8H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM72,48v8a8,8,0,0,0,16,0V48h80v8a8,8,0,0,0,16,0V48h24V80H48V48ZM208,208H48V96H208V208Z"></path>
            </svg>
            <span>Reservas</span>
        </a>
    </nav>

    <!-- Modal de imagen -->
    <div id="image-modal" class="image-modal" onclick="closeImageModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <button class="close-modal" onclick="closeImageModal()">&times;</button>
            <img id="modal-image" class="modal-image" src="" alt="">
            <div class="modal-info">
                <div id="modal-title" class="modal-title"></div>
                <div id="modal-price" class="modal-price"></div>
                <div id="modal-description" class="modal-description"></div>
                <div id="modal-badges" class="modal-badges"></div>
                <div id="modal-extra-info"></div>
            </div>
        </div>
    </div>

    <script>
        // ==========================================
        // CONFIGURACIÓN DEL RESTAURANTE
        // ==========================================
        const RESTAURANT_CONFIG = {
            name: "Ooilo Taqueria",
            iconPath: "icon.png",
            defaultPhone: "+56987654321",
            defaultHours: "Lun-Dom: 11:00 - 23:00",
            defaultAddress: "Av. Alemania 1234, Temuco, Chile"
        };

        let menuData = null;
        let configurationApplied = false;
        let specialItemIds = new Set();

        // ==========================================
        // FUNCIONES AUXILIARES
        // ==========================================

        function getDefaultImage() {
            return "https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?w=400&h=300&fit=crop";
        }

        function formatPrice(price) {
            return new Intl.NumberFormat('es-CL', {
                style: 'currency',
                currency: 'CLP',
                minimumFractionDigits: 0
            }).format(price);
        }

        // ==========================================
        // RENDERIZADO DINÁMICO
        // ==========================================

        function renderMenuDinamico(menuItems) {
            const container = document.getElementById('menu-container');
            
            if (!Array.isArray(menuItems) || menuItems.length === 0) {
                container.innerHTML = '<p class="p-4 text-center text-[#80726b]">No hay productos disponibles en este momento.</p>';
                return;
            }
            
            console.log('🔄 Renderizando menú dinámico con ' + menuItems.length + ' productos...');
            
            // Filtrar solo productos disponibles
            const productosDisponibles = menuItems.filter(function(item) {
                const disponible = item.disponible === true || item.disponible === 'true';
                if (!disponible) {
                    console.log('⚠️ Producto no disponible excluido: ' + item.nombre);
                }
                return disponible;
            });
            
            console.log('✅ Productos disponibles después del filtro: ' + productosDisponibles.length);
            
            // Agrupar productos por categoría
            const categorias = {};
            productosDisponibles.forEach(function(item) {
                const categoria = (item.categoria_nombre || item.categoria || 'Sin Categoría').trim();
                
                if (!categorias[categoria]) {
                    categorias[categoria] = {
                        nombre: categoria,
                        items: [],
                        activa: true
                    };
                }
                
                categorias[categoria].items.push(item);
            });
            
            // Filtrar categorías que tienen al menos un producto
            const categoriasConProductos = Object.values(categorias).filter(function(cat) {
                return cat.items.length > 0;
            });
            
            console.log('📁 Categorías con productos: ' + categoriasConProductos.map(function(cat) {
                return cat.nombre + ' (' + cat.items.length + ' items)';
            }).join(', '));
            
            // Ordenar categorías alfabéticamente
            categoriasConProductos.sort(function(a, b) {
                return a.nombre.localeCompare(b.nombre);
            });
            
            // Mapeo de emojis por categoría
            const emojiMap = {
                'Entradas': '🥗',
                'Platos Principales': '🍽️',
                'Tacos': '🌮',
                'Pizzas': '🍕',
                'Postres': '🍰',
                'Bebidas': '🥤',
                'Bebidas Calientes': '☕',
                'Bebidas Frías': '🥤',
                'Ensaladas': '🥗',
                'Carnes': '🥩',
                'Pescados': '🐟',
                'Vegetariano': '🌱',
                'Vegano': '🌿',
                'Comida': '🍴',
                'Especiales': '⭐',
                'Sin Categoría': '📦'
            };
            
            let categoriasHTML = '';
            let totalProductosMostrados = 0;
            
            // Renderizar cada categoría
            categoriasConProductos.forEach(function(categoria) {
                const emoji = emojiMap[categoria.nombre] || '🍴';
                
                console.log('📁 Renderizando: ' + emoji + ' ' + categoria.nombre + ' (' + categoria.items.length + ' productos)');
                
                // Header de la categoría
                categoriasHTML += '<div class="categoria-section" data-categoria="' + categoria.nombre + '">';
                categoriasHTML += '<h2 class="text-[#161413] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">';
                categoriasHTML += emoji + ' ' + categoria.nombre;
                categoriasHTML += '<span class="categoria-count text-sm text-[#80726b] font-normal ml-2">(' + categoria.items.length + ')</span>';
                categoriasHTML += '</h2>';
                
                // Items de la categoría
                categoria.items.forEach(function(item) {
                    categoriasHTML += createMenuItem(item);
                    totalProductosMostrados++;
                });
                
                categoriasHTML += '</div>';
            });
            
            // Si no hay categorías con productos
            if (categoriasConProductos.length === 0) {
                categoriasHTML = '<div class="p-8 text-center">';
                categoriasHTML += '<div class="text-6xl mb-4">🍽️</div>';
                categoriasHTML += '<h3 class="text-xl font-bold text-[#161413] mb-2">No hay productos disponibles</h3>';
                categoriasHTML += '<p class="text-[#80726b]">Estamos actualizando nuestro menú. Por favor, vuelve pronto.</p>';
                categoriasHTML += '</div>';
            }
            
            container.innerHTML = categoriasHTML;
            
            // Log del resultado final
            console.log('✅ Menú renderizado exitosamente:');
            console.log('   📁 ' + categoriasConProductos.length + ' categorías mostradas');
            console.log('   🍽️ ' + totalProductosMostrados + ' productos mostrados');
            console.log('   📋 Categorías: ' + categoriasConProductos.map(function(c) { return c.nombre; }).join(', '));
            
            // Verificar específicamente los Tacos Al Pastor
            verificarTacosAlPastor(productosDisponibles);
        }

        function verificarTacosAlPastor(productos) {
            const tacosAlPastor = productos.find(function(item) {
                return item.nombre && 
                       item.nombre.toLowerCase().includes('tacos') && 
                       item.nombre.toLowerCase().includes('pastor');
            });
            
            if (tacosAlPastor) {
                console.log('🌮 ✅ TACOS AL PASTOR CONFIRMADO:');
                console.log('   📍 Nombre: ' + tacosAlPastor.nombre);
                console.log('   📁 Categoría: ' + (tacosAlPastor.categoria_nombre || tacosAlPastor.categoria));
                console.log('   💰 Precio: ' + tacosAlPastor.precio);
                console.log('   🟢 Disponible: ' + tacosAlPastor.disponible);
                console.log('   🖼️ Imagen: ' + (tacosAlPastor.imagen || 'No disponible'));
                console.log('   🖼️ Imagen URL: ' + (tacosAlPastor.imagen_url || 'No disponible'));
                console.log('   🖼️ Imagen final: ' + (tacosAlPastor.imagen_url || tacosAlPastor.imagen || getDefaultImage()));
                
                // Verificar si está en el DOM
                setTimeout(function() {
                    const elementoEnDOM = document.querySelector('[data-item-id="' + tacosAlPastor.id + '"]');
                    if (elementoEnDOM) {
                        console.log('🌮 ✅ Tacos Al Pastor VISIBLE en la página');
                        
                        // Verificar imagen en el DOM
                        const imagenEnDOM = elementoEnDOM.querySelector('.item-image');
                        if (imagenEnDOM) {
                            const backgroundImage = window.getComputedStyle(imagenEnDOM).backgroundImage;
                            console.log('🖼️ Imagen en DOM: ' + backgroundImage);
                        }
                    } else {
                        console.log('🌮 ❌ Tacos Al Pastor NO VISIBLE en la página (problema de renderizado)');
                    }
                }, 100);
            } else {
                console.log('🌮 ❌ Tacos Al Pastor NO encontrado en los productos disponibles');
            }
        }

        function createMenuItem(item, isSpecialItem) {
            isSpecialItem = isSpecialItem || false;
            
            // ✅ CORREGIDO: Verificar ambos campos de imagen
            const imageUrl = item.imagen_url || item.imagen || getDefaultImage();
            
            const isSpecial = isSpecialItem || 
                             item.es_especial || 
                             item.categoria_nombre === 'Platos Especiales';
            
            console.log('🖼️ Imagen para ' + item.nombre + ':', {
                imagen_url: item.imagen_url,
                imagen: item.imagen,
                imageUrl_final: imageUrl,
                es_especial: isSpecial
            });
            
            let html = '';
            html += '<div class="p-4" data-item-id="' + item.id + '">';
            html += '<div class="flex items-stretch justify-between gap-4 rounded-xl">';
            html += '<div class="flex flex-col gap-1 flex-[2_2_0px]">';
            html += '<div class="flex items-center flex-wrap">';
            html += '<p class="text-[#161413] text-base font-bold leading-tight">';
            html += item.nombre + ' - <span class="price">' + formatPrice(item.precio) + '</span>';
            html += '</p>';
            
            if (item.vegetariano) {
                html += '<span class="vegetarian-badge">🌱 Vegetariano</span>';
            }
            if (item.picante) {
                html += '<span class="spicy-badge">🌶️ Picante</span>';
            }
            
            html += '</div>';
            html += '<p class="text-[#80726b] text-sm font-normal leading-normal">';
            html += (item.descripcion || 'Deliciosa preparación de nuestra cocina');
            html += '</p>';
            
            if (item.ingredientes) {
                html += '<p class="text-[#95a5a6] text-xs mt-1">';
                html += '<strong>Ingredientes:</strong> ' + item.ingredientes;
                html += '</p>';
            }
            
            if (item.tiempo_preparacion) {
                html += '<p class="text-[#95a5a6] text-xs">';
                html += '⏱️ Tiempo de preparación: ' + item.tiempo_preparacion + ' min';
                html += '</p>';
            }
            
            html += '</div>';
            html += '<div class="w-full bg-center bg-no-repeat aspect-video bg-cover rounded-xl flex-1 item-image"';
            html += ' style="background-image: url(\'' + imageUrl + '\');"';
            
            // ✅ CORREGIDO: Pasar imagen_url al modal también
            const safeNombre = item.nombre.replace(/'/g, '&apos;');
            const safeDescripcion = (item.descripcion || '').replace(/'/g, '&apos;');
            const safeIngredientes = (item.ingredientes || '').replace(/'/g, '&apos;');
            const safeTiempo = (item.tiempo_preparacion || '');
            
            html += ' onclick="openImageModal(\'' + item.id + '\', \'' + imageUrl + '\', \'' + safeNombre + '\', \'' + item.precio + '\', \'' + safeDescripcion + '\', ' + (item.vegetariano ? 'true' : 'false') + ', ' + (item.picante ? 'true' : 'false') + ', \'' + safeIngredientes + '\', \'' + safeTiempo + '\')"';
            html += ' title="Clic para ver en detalle">';
            html += '</div>';
            html += '</div>';
            html += '</div>';
            
            return html;
        }

        function createPlatosEspeciales(platosEspeciales) {
            if (!platosEspeciales || platosEspeciales.length === 0) {
                return '';
            }

            // Rastrear IDs de platos especiales para evitar duplicados
            platosEspeciales.forEach(function(plato) {
                if (plato.id) {
                    specialItemIds.add(plato.id);
                }
            });

            console.log('🌟 Platos especiales registrados: ' + Array.from(specialItemIds).join(', '));

            return platosEspeciales.map(function(plato) {
                return createMenuItem(plato, true);
            }).join('');
        }

        // ==========================================
        // CARGA DE DATOS
        // ==========================================

        function cargarMenu() {
            const loading = document.getElementById('loading');
            const errorMessage = document.getElementById('error-message');
            const mainContent = document.getElementById('main-content');

            // Mostrar loading
            loading.style.display = 'flex';
            errorMessage.style.display = 'none';
            mainContent.style.display = 'none';

            // Limpiar conjunto de platos especiales
            specialItemIds.clear();

            console.log('🔄 Cargando menú con sistema dinámico (UNION de tablas)...');
            
            // Intentar cargar desde endpoint web primero
            fetch('/api/menu-publico')
                .then(function(response) {
                    if (response.ok) {
                        return response.json();
                    }
                    throw new Error('Endpoint web no disponible');
                })
                .then(function(data) {
                    if (data.success && data.categorias) {
                        console.log('📊 Estructura web detectada (categorías agrupadas)');
                        
                        // Extraer todos los items de todas las categorías
                        var menuItems = [];
                        data.categorias.forEach(function(categoria) {
                            if (categoria.items && Array.isArray(categoria.items)) {
                                categoria.items.forEach(function(item) {
                                    item.categoria_nombre = item.categoria_nombre || categoria.nombre;
                                    item.es_especial = false;
                                    menuItems.push(item);
                                });
                            }
                        });
                        
                        var platosEspeciales = data.platos_especiales || [];
                        var restauranteInfo = data.restaurante;
                        
                        console.log('📋 Estructura web procesada: ' + menuItems.length + ' items normales de ' + data.categorias.length + ' categorías + ' + platosEspeciales.length + ' especiales');
                        
                        procesarDatos(menuItems, platosEspeciales, restauranteInfo);
                    } else {
                        throw new Error('Estructura de datos no válida');
                    }
                })
                .catch(function(error) {
                    console.log('⚠️ Endpoint web no disponible, probando /api/menu (UNION)...');
                    
                    // Fallback al endpoint UNION
                    fetch('/api/menu')
                        .then(function(response) {
                            if (!response.ok) {
                                throw new Error('HTTP ' + response.status + ': ' + response.statusText);
                            }
                            return response.json();
                        })
                        .then(function(data) {
                            if (Array.isArray(data)) {
                                console.log('📊 Estructura UNION detectada (array con flag es_especial)');
                                
                                // Separar por flag es_especial
                                var platosEspeciales = data.filter(function(item) {
                                    return item.es_especial === true;
                                });
                                var menuItems = data.filter(function(item) {
                                    return item.es_especial !== true;
                                });
                                
                                console.log('📋 Estructura UNION procesada: ' + menuItems.length + ' items normales + ' + platosEspeciales.length + ' especiales');
                                
                                procesarDatos(menuItems, platosEspeciales, null);
                            } else {
                                throw new Error('Estructura de datos no reconocida');
                            }
                        })
                        .catch(function(secondError) {
                            console.error('❌ Error cargando menú dinámico:', secondError);
                            mostrarError(secondError.message);
                        });
                });
        }

        function procesarDatos(menuItems, platosEspeciales, restauranteInfo) {
            // Log detallado de lo que se recibió
            console.log('📊 Datos recibidos (después de UNION):');
            console.log('   🍽️ Items del menú normal: ' + menuItems.length);
            console.log('   ⭐ Platos especiales: ' + platosEspeciales.length);
            console.log('   📦 Total productos: ' + (menuItems.length + platosEspeciales.length));
            
            // Verificar que tenemos datos
            if (menuItems.length === 0 && platosEspeciales.length === 0) {
                throw new Error('No se recibieron productos del servidor');
            }
            
            // Debug: Verificar categorías en los datos
            if (menuItems.length > 0) {
                var categorias = [];
                var categoriasSet = new Set();
                menuItems.forEach(function(item) {
                    if (item.categoria_nombre) {
                        categoriasSet.add(item.categoria_nombre);
                    }
                });
                categorias = Array.from(categoriasSet).filter(Boolean);
                console.log('📁 Categorías encontradas en items normales: ' + categorias.join(', '));
                
                // Buscar específicamente Tacos Al Pastor
                var tacosItems = menuItems.filter(function(item) {
                    return item.nombre && item.nombre.toLowerCase().includes('tacos');
                });
                if (tacosItems.length > 0) {
                    console.log('🌮 Items con "tacos" encontrados: ' + tacosItems.map(function(t) {
                        return t.nombre + ' (' + t.categoria_nombre + ')';
                    }).join(', '));
                }
            }
            
            // Renderizar platos especiales si los hay
            if (platosEspeciales.length > 0) {
                renderPlatosEspeciales(platosEspeciales);
                console.log('⭐ ' + platosEspeciales.length + ' platos especiales renderizados');
            } else {
                // Ocultar sección de especiales si no hay
                const section = document.getElementById('platos-especiales-section');
                if (section) {
                    section.style.display = 'none';
                }
                console.log('📝 No hay platos especiales para mostrar');
            }
            
            // Renderizar menú principal de forma dinámica
            renderMenuDinamico(menuItems);
            
            // Actualizar información del restaurante
            updateRestaurantContact(restauranteInfo);
            
            // Actualizar timestamp
            document.getElementById('last-updated').textContent = 
                'Última actualización: ' + new Date().toLocaleString('es-CL');
            
            // Mostrar contenido
            var loading = document.getElementById('loading');
            var mainContent = document.getElementById('main-content');
            loading.style.display = 'none';
            mainContent.style.display = 'flex';
            
            console.log('✅ Menú dinámico cargado exitosamente con UNION de tablas');
        }

        function mostrarError(mensaje) {
            var loading = document.getElementById('loading');
            var errorMessage = document.getElementById('error-message');
            
            loading.style.display = 'none';
            errorMessage.style.display = 'block';
            
            var errorText = errorMessage.querySelector('p');
            if (errorText) {
                errorText.textContent = 'Error: ' + mensaje + '. Por favor, inténtalo más tarde.';
            }
        }

        function renderPlatosEspeciales(platosEspeciales) {
            var section = document.getElementById('platos-especiales-section');
            var container = document.getElementById('platos-especiales-container');
            
            console.log('🌟 Procesando platos especiales: ' + platosEspeciales.length);
            
            if (!platosEspeciales || platosEspeciales.length === 0) {
                console.log('📝 No hay platos especiales para mostrar');
                section.style.display = 'none';
                return;
            }
            
            // Limpiar y crear contenido de platos especiales
            var especialesHTML = createPlatosEspeciales(platosEspeciales);
            container.innerHTML = especialesHTML;
            section.style.display = 'block';
            
            console.log('✅ Sección de platos especiales renderizada: ' + platosEspeciales.length + ' items');
        }

        function aplicarConfiguracionInicial() {
            if (configurationApplied) return;
            
            console.log('🔧 Aplicando configuración inicial del restaurante...');
            
            var restaurantName = RESTAURANT_CONFIG.name;
            var iconPath = RESTAURANT_CONFIG.iconPath;
            var phone = RESTAURANT_CONFIG.defaultPhone;
            var hours = RESTAURANT_CONFIG.defaultHours;
            var address = RESTAURANT_CONFIG.defaultAddress;
            
            // Actualizar nombre en header y banner
            document.getElementById('restaurant-name').textContent = restaurantName;
            document.getElementById('banner-restaurant-name').textContent = restaurantName;
            
            // Cargar icono personalizado
            var iconElement = document.getElementById('restaurant-icon');
            if (iconPath && iconElement) {
                iconElement.src = iconPath;
                console.log('🖼️ Cargando icono personalizado: ' + iconPath);
            }
            
            // Actualizar información de contacto desde la configuración
            document.getElementById('restaurant-phone').textContent = phone;
            document.getElementById('restaurant-hours').textContent = hours;
            document.getElementById('restaurant-address').textContent = address;
            
            // Actualizar título de la página
            document.title = restaurantName + ' - Menú Digital';
            
            configurationApplied = true;
            console.log('✅ Configuración inicial aplicada para: ' + restaurantName);
        }

        function updateRestaurantContact(restaurante) {
            if (!restaurante) {
                console.log('⚠️ No hay datos de restaurante del backend, manteniendo configuración local');
                return;
            }
            
            console.log('📞 Actualizando información de contacto desde backend...');
            
            // Solo actualizar la información de contacto si viene del backend Y es diferente
            if (restaurante.telefono && restaurante.telefono !== RESTAURANT_CONFIG.defaultPhone) {
                document.getElementById('restaurant-phone').textContent = restaurante.telefono;
                console.log('📞 Teléfono actualizado desde backend: ' + restaurante.telefono);
            }
            
            if (restaurante.horarios && restaurante.horarios !== RESTAURANT_CONFIG.defaultHours) {
                document.getElementById('restaurant-hours').textContent = restaurante.horarios;
                console.log('🕒 Horarios actualizados desde backend: ' + restaurante.horarios);
            }
            
            if (restaurante.direccion && restaurante.direccion !== RESTAURANT_CONFIG.defaultAddress) {
                document.getElementById('restaurant-address').textContent = restaurante.direccion;
                console.log('📍 Dirección actualizada desde backend: ' + restaurante.direccion);
            }
        }

        // ==========================================
        // FUNCIONES DE DEBUG
        // ==========================================

        function debugMenuDinamico() {
            console.log('🔍 === DEBUG DEL MENÚ DINÁMICO (UNION) ===');
            
            // Verificar respuesta de la API con UNION
            fetch('/api/menu')
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    console.log('📡 Respuesta de /api/menu (UNION):');
                    console.log('   📊 Tipo: ' + (Array.isArray(data) ? 'Array' : typeof data));
                    console.log('   📦 Cantidad total: ' + (Array.isArray(data) ? data.length : 'N/A'));
                    
                    if (Array.isArray(data)) {
                        // Analizar por flag es_especial
                        const normales = data.filter(function(item) { return item.es_especial !== true; });
                        const especiales = data.filter(function(item) { return item.es_especial === true; });
                        console.log('   🍽️ Items normales: ' + normales.length);
                        console.log('   ⭐ Items especiales: ' + especiales.length);
                        
                        // Buscar Tacos Al Pastor
                        const tacos = data.filter(function(item) {
                            return item.nombre && item.nombre.toLowerCase().includes('tacos');
                        });
                        console.log('   🌮 Productos con "tacos": ' + tacos.length);
                        tacos.forEach(function(taco) {
                            console.log('      - ' + taco.nombre + ' (' + taco.categoria_nombre + ', disponible: ' + taco.disponible + ', especial: ' + taco.es_especial + ')');
                        });
                    }
                })
                .catch(function(error) {
                    console.error('❌ Error en debug: ' + error.message);
                });
        }

        function testTacosAlPastor() {
            console.log('🌮 === TEST ESPECÍFICO: TACOS AL PASTOR ===');
            
            fetch('/api/menu')
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    const tacosItems = data.filter(function(item) {
                        return item.nombre && 
                               item.nombre.toLowerCase().includes('tacos') && 
                               item.nombre.toLowerCase().includes('pastor');
                    });
                    
                    if (tacosItems.length > 0) {
                        console.log('✅ TACOS AL PASTOR ENCONTRADOS EN API:');
                        tacosItems.forEach(function(taco) {
                            console.log('   📍 ID: ' + taco.id);
                            console.log('   📍 Nombre: ' + taco.nombre);
                            console.log('   📁 Categoría: ' + taco.categoria_nombre);
                            console.log('   💰 Precio: ' + taco.precio);
                            console.log('   🟢 Disponible: ' + taco.disponible);
                            console.log('   ⭐ Es especial: ' + taco.es_especial);
                            console.log('   🖼️ Campo imagen: ' + (taco.imagen || 'NULL'));
                            console.log('   🖼️ Campo imagen_url: ' + (taco.imagen_url || 'NULL'));
                            console.log('   🖼️ Imagen que se usará: ' + (taco.imagen_url || taco.imagen || getDefaultImage()));
                            console.log('   🔗 Debería aparecer en: ' + (taco.es_especial ? 'Platos Especiales' : taco.categoria_nombre));
                            console.log('   ---');
                        });
                        
                        // Verificar en DOM después de renderizar
                        setTimeout(function() {
                            tacosItems.forEach(function(taco) {
                                const elementoEnDOM = document.querySelector('[data-item-id="' + taco.id + '"]');
                                if (elementoEnDOM) {
                                    console.log('🌮 ✅ ' + taco.nombre + ' VISIBLE en DOM');
                                    
                                    const imagenEnDOM = elementoEnDOM.querySelector('.item-image');
                                    if (imagenEnDOM) {
                                        const style = window.getComputedStyle(imagenEnDOM);
                                        const backgroundImage = style.backgroundImage;
                                        console.log('🖼️ Imagen renderizada: ' + backgroundImage);
                                        
                                        if (backgroundImage === 'none' || backgroundImage.includes('none')) {
                                            console.log('⚠️ PROBLEMA: Imagen no se está mostrando correctamente');
                                        }
                                    }
                                } else {
                                    console.log('🌮 ❌ ' + taco.nombre + ' NO VISIBLE en DOM');
                                }
                            });
                        }, 500);
                        
                    } else {
                        console.log('❌ TACOS AL PASTOR NO ENCONTRADOS EN API');
                        console.log('💡 Verificar:');
                        console.log('   1. ¿Están en la base de datos?');
                        console.log('   2. ¿Tienen disponible = true?');
                        console.log('   3. ¿Su categoría tiene activo = true?');
                        console.log('   4. ¿El nombre contiene "tacos" y "pastor"?');
                    }
                })
                .catch(function(error) {
                    console.error('❌ Error verificando Tacos Al Pastor: ' + error.message);
                });
        }

        // ==========================================
        // FUNCIONALIDAD DE MODAL DE IMAGEN
        // ==========================================

        function openImageModal(itemId, imageUrl, nombre, precio, descripcion, vegetariano, picante, ingredientes, tiempoPreparacion) {
            var modal = document.getElementById('image-modal');
            var modalImage = document.getElementById('modal-image');
            var modalTitle = document.getElementById('modal-title');
            var modalPrice = document.getElementById('modal-price');
            var modalDescription = document.getElementById('modal-description');
            var modalBadges = document.getElementById('modal-badges');
            var modalExtraInfo = document.getElementById('modal-extra-info');
            
            // Configurar imagen
            modalImage.src = imageUrl;
            modalImage.alt = nombre;
            
            // Configurar información
            modalTitle.textContent = nombre;
            modalPrice.textContent = formatPrice(precio);
            modalDescription.textContent = descripcion || 'Deliciosa preparación de nuestra cocina';
            
            // Configurar badges
            var badgesHTML = '';
            if (vegetariano) {
                badgesHTML += '<span class="vegetarian-badge">🌱 Vegetariano</span>';
            }
            if (picante) {
                badgesHTML += '<span class="spicy-badge">🌶️ Picante</span>';
            }
            modalBadges.innerHTML = badgesHTML;
            
            // Configurar información extra
            var extraHTML = '';
            if (ingredientes && ingredientes.trim() !== '') {
                extraHTML += '<p><strong>🥘 Ingredientes:</strong> ' + ingredientes + '</p>';
            }
            if (tiempoPreparacion && tiempoPreparacion.trim() !== '') {
                extraHTML += '<p><strong>⏱️ Tiempo de preparación:</strong> ' + tiempoPreparacion + ' min</p>';
            }
            
            if (extraHTML !== '') {
                modalExtraInfo.innerHTML = '<div class="modal-extra-info">' + extraHTML + '</div>';
            } else {
                modalExtraInfo.innerHTML = '';
            }
            
            // Mostrar modal
            modal.classList.add('show');
            document.body.classList.add('modal-open');
            
            // Log para debug
            console.log('🖼️ Modal abierto para:', nombre);
            
            // Manejar error de carga de imagen
            modalImage.onerror = function() {
                this.src = getDefaultImage();
                console.log('⚠️ Error cargando imagen, usando imagen por defecto');
            };
        }

        function closeImageModal(event) {
            // Si se hace clic en el backdrop o en el botón cerrar
            if (!event || event.target.id === 'image-modal' || event.target.classList.contains('close-modal')) {
                var modal = document.getElementById('image-modal');
                modal.classList.remove('show');
                document.body.classList.remove('modal-open');
                
                console.log('🖼️ Modal cerrado');
            }
        }

        // Cerrar modal con tecla Escape
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeImageModal();
            }
        });

        // Prevenir scroll en modal en dispositivos móviles
        function preventModalScroll() {
            var modal = document.getElementById('image-modal');
            modal.addEventListener('touchmove', function(event) {
                if (event.target === modal) {
                    event.preventDefault();
                }
            }, { passive: false });
        }

        // ==========================================
        // MEJORAS DE ACCESIBILIDAD PARA IMÁGENES
        // ==========================================

        function setupImageAccessibility() {
            // Agregar indicadores visuales para imágenes clickeables
            var images = document.querySelectorAll('.item-image');
            images.forEach(function(img) {
                // Agregar atributos de accesibilidad
                img.setAttribute('role', 'button');
                img.setAttribute('tabindex', '0');
                img.setAttribute('aria-label', 'Clic para ver imagen en detalle');
                
                // Manejar navegación por teclado
                img.addEventListener('keydown', function(event) {
                    if (event.key === 'Enter' || event.key === ' ') {
                        event.preventDefault();
                        img.click();
                    }
                });
            });
        }

        // ==========================================
        // NAVEGACIÓN MÓVIL (funciones existentes)
        // ==========================================

        function setActiveNavItem(clickedItem) {
            // Remover active de todos los items
            var navItems = document.querySelectorAll('.mobile-nav-item');
            navItems.forEach(function(item) {
                item.classList.remove('active');
            });
            
            // Agregar active al item clickeado
            clickedItem.classList.add('active');
        }

        // ==========================================
        // INICIALIZACIÓN
        // ==========================================

        document.addEventListener('DOMContentLoaded', function() {
            console.log('🍽️ Menú digital inicializando...');
            console.log('⚙️ Configuración actual: ' + JSON.stringify(RESTAURANT_CONFIG, null, 2));
            
            // 1. Aplicar configuración inicial
            aplicarConfiguracionInicial();
            
            // 2. Forzar actualización de información
            setTimeout(function() {
                console.log('🔄 Forzando actualización de información...');
                document.getElementById('restaurant-phone').textContent = RESTAURANT_CONFIG.defaultPhone;
                document.getElementById('restaurant-hours').textContent = RESTAURANT_CONFIG.defaultHours;
                document.getElementById('restaurant-address').textContent = RESTAURANT_CONFIG.defaultAddress;
            }, 100);
            
            // 3. Funciones de debug en desarrollo
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                window.debugMenuDinamico = debugMenuDinamico;
                window.testTacosAlPastor = testTacosAlPastor;
                console.log('🔧 Modo desarrollo activado:');
                console.log('   - debugMenuDinamico(): Debug completo del sistema');
                console.log('   - testTacosAlPastor(): Test específico de Tacos Al Pastor');
            }
            
            // 4. Cargar menú
            cargarMenu();
            
            // 5. Configurar funcionalidades de imagen
            setTimeout(function() {
                preventModalScroll();
                setupImageAccessibility();
            }, 1000);
        });

        // Actualizar menú cada 5 minutos
        setInterval(function() {
            console.log('🔄 Actualizando datos del menú...');
            cargarMenu();
        }, 5 * 60 * 1000);

        console.log('🍽️ Menú digital inicializado con sistema dinámico: ' + RESTAURANT_CONFIG.name);
    </script>
</body>
</html>